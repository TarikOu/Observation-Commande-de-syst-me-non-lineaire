function Xp = myFunBis(t,xt)
% Data
c1 = 0.01; c2 = 0.1; c3 = 0.01; c4 = 0.67; c5 = 0;
M = 1; D = 1;
r1 =  -(c3 + c4*(xt(1))^2 + D*c1)/M; r2 = -D*c2*(xt(2))^2/M;
%
Z1 = xt(3)^2; Z2 = xt(4)^2;
M1 = (4/9)*Z1; M2 = 1 - (4/9)*Z1;
N1 = (4/9)*Z2; N2 = 1-(4/9)*Z2;
h1 = M1*N1; h2 = M1*N2; h3 = M2*N1; h4 = M2*N2;
% Sys non lineaire 
A = [0 1; r1 r2]; B = [0; 1 + c5*(xt(2))^2/M];
% sys lineaires equivalents
A1 = [0 1 ;-1.5275 -0.225];
A2 = [0 1 ;-1.5275 0];
A3 = [0 1 ;-0.02 -0.225];
A4 = [0 1 ; -0.02 0];
% gain du CMD (voir TD_01_exo_01.m)
K1 = [0.0044, -0.9519];
K2 = [0.0044, -1.1769];
K3 = [-1.5031, -0.9519];
K4 = [-1.5031, -1.1769];
% 
x1 = [xt(1); xt(2)];
x2 = [xt(3); xt(4)];
u1 = (h1*K1 + h2*K2 + h3*K3 + h4*K4)*x1;
u2 = (h1*K1 + h2*K2 + h3*K3 + h4*K4)*x2;
%
xp1 = A*x1 + B*u1;
xp2 = h1*(A1*x2 + B*u2) + h2*(A2*x2 + B*u2) + ...
      h3*(A3*x2 + B*u2)+ h4*(A4*x2 + B*u2);

Xp = [xp1; xp2];

