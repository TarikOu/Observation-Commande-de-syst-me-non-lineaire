function Xp = myFun(t,x)

% u = 0.5*sin(0.5*pi*t);
u = 0;
xp1 = x(1);
xp2 = (-0.02-0.67*x(1)^2)*x(1) + 0.1*x(2)^3 + u;

Z1 = x(3)^2; Z2 = x(4)^2;

M1 = (4/9)*Z1; M2 = 1 - (4/9)*Z1;
N1 = (4/9)*Z2; N2 = 1 - (4/9)*Z2;

h1 = M1*N1; h2 = M1*N2; h3 = M2*N1; h4 = M2*N2;

A1 = [0 1; -1.5275 -0.2250];
A2 = [0 1; -1.5275 0];
A3 = [0 1; -0.02 -0.2250];
A4 = [0 1; -0.02 0];
B  = [0; 1];

X2 = [x(3); x(4)];
Xp2 = h1*(A1*X2 + B*u) + h2*(A2*X2 + B*u) + h3*(A3*X2 + B*u) + h4*(A4*X2 + B*u);

Xp = [xp1; xp2; Xp2]
